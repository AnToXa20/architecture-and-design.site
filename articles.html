<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Статьи - Архитектурное Бюро</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'white': '#FFFFFF',
                        'black': '#000000',
                        'light-gray': '#E6E6E6',
                        'gray': '#A6A6A6',
                        'dark-gray': '#2F2F2F',
                        'gold-1': '#FFC107',
                        'gold-2': '#E8A317',
                    },
                    fontFamily: {
                        'montserrat': ['Montserrat', 'sans-serif'],
                        'roboto': ['Roboto', 'sans-serif'],
                        'playfair': ['Playfair Display', 'serif'],
                    },
                }
            }
        }
    </script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="font-roboto text-dark-gray bg-white">
    <!-- Шапка сайта -->
    <header class="bg-white fixed w-full top-0 shadow-md z-50">
        <div class="container mx-auto py-4 px-4 flex justify-between items-center">
            <!-- Логотип -->
            <a href="index.html" class="flex items-center">
                <img src="Logo_black.svg" alt="Логотип" class="logo-image">
            </a>

            <!-- Навигация для десктопа -->
            <nav class="hidden lg:flex">
                <a href="portfolio.html" class="header-link">Портфолио</a>
                <a href="stages.html" class="header-link">Этапы работы</a>
                <a href="articles.html" class="header-link">Статьи</a>
                <a href="services.html" class="header-link">Услуги и цены</a>
                <a href="ai-design.html" class="header-link">ИИ дизайн</a>
                <a href="about.html" class="header-link">О нас</a>
                <a href="contacts.html" class="header-link">Контакты</a>
            </nav>

            <!-- Кнопка мобильного меню -->
            <button id="mobile-menu-button" class="lg:hidden flex flex-col justify-center items-center">
                <span class="block w-6 h-0.5 bg-black mb-1.5"></span>
                <span class="block w-6 h-0.5 bg-black mb-1.5"></span>
                <span class="block w-6 h-0.5 bg-black"></span>
            </button>
        </div>

        <!-- Мобильное меню -->
        <div id="mobile-menu" class="lg:hidden hidden absolute top-full left-0 w-full bg-white shadow-md">
            <nav class="flex flex-col p-4">
                <a href="portfolio.html" class="py-2 header-link">Портфолио</a>
                <a href="stages.html" class="py-2 header-link">Этапы работы</a>
                <a href="articles.html" class="py-2 header-link">Статьи</a>
                <a href="services.html" class="py-2 header-link">Услуги и цены</a>
                <a href="ai-design.html" class="py-2 header-link">ИИ дизайн</a>
                <a href="about.html" class="py-2 header-link">О нас</a>
                <a href="contacts.html" class="py-2 header-link">Контакты</a>
            </nav>
        </div>
    </header>

    <!-- Основное содержимое -->
    <main class="pt-32 pb-20">
        <div class="container mx-auto px-4 max-w-6xl">
            <h1 class="text-4xl md:text-5xl font-montserrat font-bold mb-4 text-center">
                Статьи
            </h1>
            <div class="w-20 h-1 bg-gold-1 mx-auto mb-8"></div>
            
            <!-- Сетка статей -->
            <div id="articles-grid" class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                <!-- Статьи будут загружены из базы данных -->
                <div class="flex justify-center items-center col-span-full">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-gold-1 mx-auto mb-4"></div>
                        <p class="text-gray">Загрузка статей...</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Подвал сайта -->
    <footer class="bg-dark-gray text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <div>
                    <h3 class="font-montserrat text-xl mb-4">Контакты</h3>
                    <ul class="space-y-2">
                        <li>Телефон: +7 XXX XXX XX XX</li>
                        <li>Email: info@architecture-bureau.com</li>
                        <li>Адрес: г. Москва, Новинский бульвар 25 к.10 оф.18</li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-montserrat text-xl mb-4">Наши услуги</h3>
                    <ul class="space-y-2">
                        <li><a href="services.html" class="text-white hover:text-gold-1 transition-colors">Архитектурное проектирование</a></li>
                        <li><a href="services.html" class="text-white hover:text-gold-1 transition-colors">Дизайн интерьера</a></li>
                        <li><a href="services.html" class="text-white hover:text-gold-1 transition-colors">Ландшафтный дизайн</a></li>
                        <li><a href="ai-design.html" class="text-white hover:text-gold-1 transition-colors">ИИ дизайн</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-montserrat text-xl mb-4">Информация</h3>
                    <ul class="space-y-2">
                        <li><a href="stages.html" class="text-white hover:text-gold-1 transition-colors">Этапы работы</a></li>
                        <li><a href="portfolio.html" class="text-white hover:text-gold-1 transition-colors">Портфолио</a></li>
                        <li><a href="about.html" class="text-white hover:text-gold-1 transition-colors">О нас</a></li>
                        <li><a href="articles.html" class="text-white hover:text-gold-1 transition-colors">Статьи</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="flex flex-col items-center mt-8 pt-8 border-t border-gray">
                <img src="Logo.svg" alt="Логотип" class="w-32 h-32 mb-4">
                <p class="text-center text-sm">© <span id="current-year"></span> Архитектурное Бюро. Все права защищены.</p>
            </div>
        </div>
    </footer>

    <script>
    // Установка текущего года в футере
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('current-year').textContent = new Date().getFullYear();
    });
    
    // Обработка мобильного меню
    document.addEventListener('DOMContentLoaded', function() {
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        mobileMenuButton.addEventListener('click', function() {
            mobileMenu.classList.toggle('hidden');
        });
    });

    // Загрузка статей из базы данных
    document.addEventListener('DOMContentLoaded', function() {
        loadArticles();
    });

    async function loadArticles() {
        try {
            const response = await fetch('/api/db/articles');
            const data = await response.json();

            if (data.success && data.articles) {
                renderArticles(data.articles);
            } else {
                showError('Не удалось загрузить статьи');
            }
        } catch (error) {
            console.error('Ошибка загрузки статей:', error);
            showError('Ошибка подключения к серверу');
        }
    }

    function renderArticles(articles) {
        const grid = document.getElementById('articles-grid');
        grid.innerHTML = '';

        if (articles.length === 0) {
            grid.innerHTML = `
                <div class="col-span-full text-center py-12">
                    <p class="text-gray text-lg">Пока нет опубликованных статей</p>
                </div>
            `;
            return;
        }

        articles.forEach(article => {
            const articleCard = createArticleCard(article);
            grid.appendChild(articleCard);
        });
    }

    function createArticleCard(article) {
        const card = document.createElement('a');
        card.href = `article.html?id=${article.id}`;
        card.className = 'article-card group';

        // Форматируем дату
        const formattedDate = formatDate(article.publication_date);

        card.innerHTML = `
            <div class="relative h-56 bg-dark-gray mb-4 overflow-hidden">
                ${article.main_image_url ? 
                    `<img src="${article.main_image_url}" alt="${article.title}" class="w-full h-full object-cover">` :
                    `<div class="w-full h-full flex items-center justify-center text-white text-xl">
                        ${article.title}
                    </div>`
                }
                <div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <p class="text-white text-lg font-montserrat font-semibold px-4 text-center">Читать статью</p>
                </div>
            </div>
            <h3 class="text-xl font-montserrat font-semibold mb-2">${escapeHtml(article.title)}</h3>
            <p class="text-gray mb-2">${formattedDate}</p>
            <p class="text-base">${escapeHtml(article.short_description || 'Описание статьи')}</p>
        `;

        return card;
    }

    function formatDate(dateString) {
        if (!dateString) return '';
        
        const date = new Date(dateString);
        const months = [
            'января', 'февраля', 'марта', 'апреля', 'мая', 'июня',
            'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'
        ];
        
        const day = date.getDate();
        const month = months[date.getMonth()];
        const year = date.getFullYear();
        
        return `${day} ${month} ${year}`;
    }

    function escapeHtml(text) {
        if (!text) return '';
        const map = {
            '&': '&amp;',
            '<': '&lt;',
            '>': '&gt;',
            '"': '&quot;',
            "'": '&#039;'
        };
        return text.replace(/[&<>"']/g, m => map[m]);
    }

    function showError(message) {
        const grid = document.getElementById('articles-grid');
        grid.innerHTML = `
            <div class="col-span-full text-center py-12">
                <div class="text-red-500 text-lg mb-4"> ${message}</div>
                <button onclick="loadArticles()" class="bg-gold-1 text-black px-6 py-2 rounded hover:bg-gold-2 transition-colors">
                    Попробовать снова
                </button>
            </div>
        `;
    }
    </script>
</body>
</html> 